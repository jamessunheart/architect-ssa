<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üß† Architect SSA v3</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      padding: 2rem;
      background: #f9f9f9;
      color: #222;
    }
    h1 {
      font-size: 2rem;
      margin-bottom: 1rem;
    }
    textarea, input {
      width: 100%;
      margin-bottom: 1rem;
      padding: 0.75rem;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
    }
    button {
      background-color: #4f46e5;
      color: white;
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
    }
    pre {
      margin-top: 1rem;
      background: #eee;
      padding: 1rem;
      border-radius: 6px;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <h1>üß† Architect SSA v3</h1>
  
  <textarea id="prompt" rows="5" placeholder="Describe your app idea here..."></textarea>

  <label for="apis">APIs to integrate (comma-separated):</label>
  <input id="apis" placeholder="e.g., Stripe, Twilio, Notion" />

  <button onclick="build()">Build App</button>

  <pre id="status">üü¢ Ready for your vision...</pre>

  <script>
    async function build() {
      const prompt = document.getElementById('prompt').value;
      const apis = document.getElementById('apis').value
        .split(',')
        .map(s => s.trim())
        .filter(Boolean);
      const status = document.getElementById('status');
      status.textContent = '‚öôÔ∏è Building...';

      try {
        const res = await fetch('/api/build', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ prompt, integrations: apis })
        });

        if (!res.ok) {
          const text = await res.text();
          throw new Error("Server responded with error: " + text);
        }

        const result = await res.json();
        console.log("‚úÖ GPT Response:", result);

        if (result.url) {
          status.innerHTML = `‚úÖ App ready: <a href="${result.url}" target="_blank">Open App</a>`;
        } else {
          status.textContent = result.error || "‚ö†Ô∏è Unknown error occurred.";
        }

      } catch (err) {
        console.error("‚ùå GPT Call Failed:", err.message);
        status.textContent = "‚ùå Build failed: " + err.message;
      }
    }
  </script>
</body>
</html>
